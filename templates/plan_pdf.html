<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8" />
<title>plan</title>
<meta name="frm_plan" content="form planea" />
<meta name="PM1" content="width=device-width, initial-scale=1.0" />
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
  
</head>

  <script>
    document.getElementById('download-pdf').addEventListener('click', () => {
      // Selecciona el elemento que quieres convertir a PDF, por ejemplo todo el body o un div específico
      const element = document.body; // o document.getElementById('mi-contenido')

      const options = {
        margin:       0.75,
        filename:     'planX.pdf',
        image:        { type: 'jpeg', quality: 0.98 },
        html2canvas:  { scale: 1 },
        jsPDF:        { unit: 'in', format: 'a4', orientation: 'landscape' }
      };

      // Genera y descarga el PDF
      html2pdf().set(options).from(element).save();
    });
  </script>



<script>
      document.addEventListener('DOMContentLoaded', function() {
        const inputs = document.querySelectorAll('input[type="text"], input[type="number"], textarea');

        inputs.forEach(function(input) {

        input.addEventListener('input', function() {
            input.value = input.value.toUpperCase();
            });

        });
      });
    </script>


{% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          <div class="container mt-3">
            {% for category, message in messages %}
              <div class="alert alert-{{ 'danger' if category == 'danger' else 'success' }}" role="alert">
                {{ message }}
              </div>
            {% endfor %}
          </div>
        {% endif %}
      {% endwith %}

<style>
  .form-control{
    font-size:14px;
  }


  .field-container {
      display: flex;
      margin-bottom: 12px;
  }
  .field-label {
      width: 50%;
      font-weight: bold;
  }
  .field-value {
      width: 50%;
      border: 1px solid #aaa;
      padding: 6px;
      white-space: pre-wrap;
      background-color: #f9f9f9;
  }

  .field-long {
      width: 50%;
      border: 1px solid #aaa;
      padding: 6px;
      white-space: pre-wrap;
      background-color: #f9f9f9;
  }

  .field-short {
  width: 25%;
  border: 1px solid #aaa;
  padding: 6px;
  white-space: pre-wrap;
  background-color: #f9f9f9;

</style>

<body>
  <div class="container">







    <form>

      <div>
        <h2>Planeación {{ i.id }}</h2>
      </div>

      <div class="row g-2 mb-3">
        <div class="col-sm-6">
          <label for="cve" class="form-label">Clave:</label><br>
          <input class="field-short" type="text" class="form-control" name="cve" value="{{ i.cve }}" readonly>
        </div>
        <div class="col-sm-6">
          <label for="created_at" class="form-label">Fecha de creación:</label><br>
          <input class="field-short" type="text" class="form-control" name="created_at" value="{{ i.created_at }}" readonly>
        </div>
      </div>

    <div style="background-color:rgb(120,120,0,0.5)"> 
      <h3>Datos Generales</h3>
      </div>
      <div class="mb-3 row g-3">
        <div class="col-sm-4">
        <label for="plantel" class="form-label mb-0" style="font-weight:bold;">Plantel</label><br>
        <label class="field-short" type="text" class="form-control" name="plantel">{{ i.plantel}}</label>
        </div>
        <div class="col-sm-4">
        <label for="ciclo" class="form-label  mb-0" style="font-weight:bold;">Ciclo</label><br>
        <label class="field-short" type="text" class="form-control" name="ciclo">{{ i.ciclo }}</label>
        </div>
        <div class="col-sm-4">
        <label class="form-label mb-0" for="periodo" style="font-weight:bold;">Periodo</label><br>
          <label class="field-short" type="text" class="form-control" name="periodo">{{ i.periodo }}</label>
        </div>
      </div>
      <div class="mb-3 row g-3">
        <div class="col-sm-4">
        <label  class="form-label  mb-0" for="carrera" style="font-weight:bold;">Carrera</label><br>
          <label class="field-short" type="text" class="form-control" name="carrera">{{ i.carrera }}</label>
        </select>
        </div>
        <div class="col-sm-4">
        <label class="form-label mb-0" for="semestre" style="font-weight:bold;">Semestre</label><br>
          <label class="field-short" type="text" class="form-control" name="semestre">{{ i.semestre }}</label>
        </div>
        <div class="col-sm-4">
        <label class="form-label mb-0" for="grupos" style="font-weight:bold;">Grupo(s)</label><br>
        <label class="field-short" type="text" class="form-control" name="grupos">{{ i.grupos }}</label>
        </div>
        
        <div class="col-sm-9">
          <label class="form-label mb-0" style="font-weight:bold;">Asignatura </label><br>
        {% set asignaturas = {'PM1': 'Pensamiento Matemàtico 1', 'PM3': 'Pensamiento matemático 3', 'inocAgr': 'Inocuidad en la Agricultura'} %}
        <input type="text" 
               class="form-control" 
               value="{{ i.asig }}" 
               title="{{ asignaturas[i.asig|string] }}" 
               readonly>
        </div>
<!--
      <div class="col-sm-12">
        <label class="form-label mb-0" for="asig" style="font-weight:bold;">Asignatura</label>
        <label type="text" class="form-control" name="asig">{{ i.asig }}</label>
      </div>
-->
        <div class="mb-3 row g-2">
          <div class="col-sm-6">
          <label for="prop" class="form-label mb-0" style="font-weight:bold;">Propósito formativo</label><br>
            <pre class="field-long" style="border:1px solid #ccc; padding:10px;">{{ i.prop }}</pre>
          </div>

          <div class="col-sm-6">
          <label for="temas" class="form-label mb-0" style="font-weight:bold;">Temas</label><br>
            <pre class="field-long" style="border:1px solid #ccc; padding:10px;">{{ i.temas }}</pre>
            
            </div>
      </div>



      </div>
      <div class="mb-3 row g-3">
        <div class="col-sm-5">
        <label for="horas_sem" class="form-label mb-0" style="font-weight:bold;">horas/semana</label><br>
          <label class="field-short" type="text" class="form-control" name="horas_sem">{{ i.horas_sem }}</label>
        </div>
        <div class="col-sm-7">
        <label for="docenteID" class="form-label mb-0" style="font-weight:bold;">Docente</label><br>
          <label class="field-short" type="text" class="form-control" name="docenteID">{{ i.docenteID }}</label>
        </div>
      </div>
      <div class="mb-3 row g-1">
        <div class="col-sm-12">
        <label  for="imparte" class="form-label mb-0" style="font-weight:bold;">Período de impartición</label><br>
          <label class="field-short" type="text" class="form-control" name="imparte">{{ i.imparte }}</label>
        </div>
      </div>


    <div style="background-color:rgb(120,120,0,0.5)">
        <h3>Asignaturas transversales:</h3> 
    </div>


        <div>
        <label for="trAsig1" class="form-label mb-0" style="font-weight:bold;">Asignatura 1</label><br>
          {% set asignaturas = {'CD1': 'Cultura Digital 1', 'LCM1': 'Lengua y Comunicación 1'} %}
          <input type="text" 
                 class="form-control" 
                 value="{{ i.trAsig1 }}" 
                 title="{{ asignaturas[i.trAsig1|string] }}" 
                 readonly>

        <label for="trtema1" class="form-label mb-0" style="font-weight:bold;">Tema</label><br>
          <label class="field-long" type="text" class="form-control mb-4" name="trtema1">{{ i.trtema1 }}</label>
        </div>


    <div>
        <label for="trAsig2" class="form-label mb-0" style="font-weight:bold;">Asignatura 2</label><br>
      {% set asignaturas = {'CD1': 'Cultura Digital 1', 'LCM1': 'Lengua y Comunicación 1'} %}
      <input type="text" 
             class="form-control" 
             value="{{ i.trAsig2 }}" 
             title="{{ asignaturas[i.trAsig1|string] }}" 
             readonly>
        <label for="trtema2" class="form-label mb-0" style="font-weight:bold;">Tema</label><br>
          <label class="field-long" type="text" class="form-control mb-4" name="trtema2">{{ i.trtema2 }}</label>

    </div>
    <div>

        <label for="trAsig3" class="form-label mb-0" style="font-weight:bold;">Asignatura 3</label><br>
      {% set asignaturas = {'CD1': 'Cultura Digital 1', 'LCM1': 'Lengua y Comunicación 1'} %}
      <input type="text" 
             class="form-control" 
             value="{{ i.trAsig3 }}" 
             title="{{ asignaturas[i.trAsig1|string] }}" 
             readonly>

        <label for="trtema3" class="form-label mb-0" style="font-weight:bold;">Tema</label><br>
          <label class="field-long" type="text" class="form-control mb-4" name="trtema3">{{ i.trtema3 }}</label>

    </div>



    <div style="background-color:rgb(120,120,0,0.5)">
        <h3>Apertura:</h3> 
    </div>
      <div class="mb-3 row g-2">

        <div class="col-sm-5">
          <label for="apDur" class="form-label mb-0" style="font-weight:bold;">Duración<br>(minutos)</label>
          <label class="field-short" type="text" class="form-control" name="apDur">{{ i.apDur }}</label>
        </div>
        <div class="col-sm-7">
          <label for="apEv" class="form-label mb-0" style="font-weight:bold;"><br>Evidencia</label>
          <label class="field-short" type="text" class="form-control" name="apEv">{{ i.apEv }}</label>
        </div>
      </div>
      <div class="mb-3 row g-2">
        <div class="col-sm-7">
          <label for="apIns" class="form-label mb-0" style="font-weight:bold;"><br>Instrumento</label>
          <label class="field-short" type="text" class="form-control" name="apIns">{{ i.apIns }}</label>
        </div>
        <div class="col-sm-5">
          <label for="apPond" class="form-label mb-0" style="font-weight:bold;"><br>Ponderación (%)</label>
          <label class="field-short" type="text" class="form-control" name="apPond">{{ i.apPond }}</label>
        </div>
      </div>
      <div class="mb-3 row g-1">

          <label for="apAct" class="form-label mb-0" style="font-weight:bold;">Actividades de apertura:</label>
          <pre class="field-long" style="border:1px solid #ccc; padding:10px;">{{ i.apAct }}</pre>

      </div>

    <div style="background-color:rgb(120,120,0,0.5)">
        <h3>Desarrollo:</h3> 
    </div>
      <div class="mb-3 row g-2">

        <div class="col-sm-5">
            <label for="deDur" class="form-label mb-0" style="font-weight:bold;">Duración<br>(minutos)</label>
            <label class="field-short" type="text" class="form-control" name="deDur">{{ i.deDur }}</label>
        </div>
        <div class="col-sm-7">
            <label for="deEv" class="form-label mb-0" style="font-weight:bold;"><br>Evidencia</label>
            <label class="field-short" type="text" class="form-control" name="deEv">{{ i.deEv }}</label>
        </div>
      </div>
      <div class="mb-3 row g-2">
        <div class="col-sm-7">
            <label for="deIns" class="form-label mb-0" style="font-weight:bold;"><br>Instrumento</label>
            <label class="field-short" type="text" class="form-control" name="deIns">{{ i.deIns }}</label>
        </div>
          <div class="col-sm-5">
            <label for="dePond" class="form-label mb-0" style="font-weight:bold;"><br>Ponderación (%)</label>
            <label class="field-short" type="text" class="form-control" name="dePond">{{ i.dePond }}</label>
          </div>
        </div>
        <div class="mb-3 row g-1">

            <label for="deAct" class="form-label mb-0" style="font-weight:bold;">Actividades de desarrollo:</label>
            <pre class="field-long" style="border:1px solid #ccc; padding:10px;">{{ i.deAct }}</pre>

        </div>

    <div style="background-color:rgb(120,120,0,0.5)">
        <h3>Cierre:</h3> 
    </div>

        <div class="mb-3 row g-2">

      <div class="col-sm-5">
        <label for="ciDur" class="form-label mb-0" style="font-weight:bold;">Duración<br>(minutos)</label>
        <label class="field-short" type="text" class="form-control" name="ciDur">{{ i.ciDur }}</label>
      </div>
      <div class="col-sm-7">
        <label for="ciEv" class="form-label mb-0" style="font-weight:bold;"><br>Evidencia</label>
        <label class="field-short" type="text" class="form-control" name="ciEv">{{ i.ciEv }}</label>
      </div>
    </div>
      <div class="mb-3 row g-2">
      <div class="col-sm-7">
        <label for="ciIns" class="form-label mb-0" style="font-weight:bold;"><br>Instrumento</label>
        <label class="field-short" type="text" class="form-control" name="ciIns">{{ i.ciIns }}</label>
      </div>
      <div class="col-sm-5">
        <label for="ciPond" class="form-label mb-0" style="font-weight:bold;"><br>Ponderación (%)</label>
        <label class="field-short" type="text" class="form-control" name="ciPond">{{ i.ciPond }}</label>
      </div>
      </div>
      <div class="mb-3 row g-1">

        <label for="ciAct" class="form-label mb-0" style="font-weight:bold;">Actividades de cierre:</label>
        <pre class="field-long" style="border:1px solid #ccc; padding:10px;">{{ i.ciAct }}</pre>

      </div>
      {% set ns = namespace(total=0) %}



                    {% set apertura = i.apPond | int %}
                    {% set desarrollo = i.dePond  | int %}
                    {% set cierre =  i.ciPond  | int %}
                    {% set parcial_sum = apertura + desarrollo + cierre %}
                    {% set ns.total = ns.total + parcial_sum %}



            {% if ns.total != 100 %}

            <text class='partial-footer-total' style="color:red;">Total ponderado: {{ ns.total }}%</text>
            {% else %}
            <text class='partial-footer-total' style="color:green;">Total ponderado: {{ ns.total }}%</text>
            {% endif %}
<br>



      {% set ns = namespace(total=0) %}



                    {% set tapertura = i.apDur | int %}
                    {% set tdesarrollo = i.deDur | int %}
                    {% set tcierre = i.ciDur | int %}
                    {% set parcial_sum = tapertura + tdesarrollo + tcierre %}
                    {% set ns.total = ns.total + parcial_sum %}
                    {% set horasem = i.horas_sem | int %}


            {% if ns.total/60 != horasem/1 %}

            <text class='partial-footer-total' style="color:red;">Total tiempo: {{ ns.total/60 }}                         hrs</text>
            {% else %}
            <text class='partial-footer-total' style="color:green;">Total tiempo: {{ ns.total/60 }}                         hrs</text>
            {% endif %}

<br><br><br>

    <div style="background-color:rgb(120,120,0,0.5)">
        <h3>Complementos:</h3> 
    </div>
    <div class="mb-3 row g-3">
        <div class="col-sm-4">
        <label for="materiales" class="form-label mb-0" style="font-weight:bold;">Materiales:</label>
          <pre class="field-short" style="border:1px solid #ccc; padding:10px;">{{ i.materiales }}</pre>
        </div>
        <div class="col-sm-4">
        <label for="equipo" class="form-label mb-0" style="font-weight:bold;">Equipo:</label>
          <pre class="field-short" style="border:1px solid #ccc; padding:10px;">{{ i.equipo }}</pre>
        </div>
        <div class="col-sm-4">
        <label for="fuentes" class="form-label mb-0" style="font-weight:bold;">Fuentes:</label>
          <pre class="field-long" style="border:1px solid #ccc; padding:10px;">{{ i.fuentes }}</pre>
        </div>
    </div>

    <div style="background-color:rgb(120,120,0,0.5)">
        <h3>Validación:</h3> 
    </div>
    <div class="mb-3 row g-3">
        <div class="col-sm-4">
        <label for="elabora" class="form-label mb-0" style="font-weight:bold;">Elabora:</label>
        <label class="field-short" type="text" class="form-control" name="elabora">{{ i.elabora }}</label>
        </div>
        <div class="col-sm-4">
        <label for="revisa" class="form-label mb-0" style="font-weight:bold;">Revisa:</label>
        <label class="field-short" type="text" class="form-control" name="revisa">{{ i.revisa }}</label>
        </div>
        <div class="col-sm-4">
        <label for="avala" class="form-label mb-0" style="font-weight:bold;">Avala:</label>
        <label class="field-short" type="text" class="form-control" name="avala">{{ i.avala }}</label>



        </div>
    </div>

      <a href="{{ url_for('download_pdf', id=i['id']) }}" class="btn btn-success" target="_blank">
        📄 Descargar PDF
      </a>

  <a href="{{ request.referrer }}">
      <button type="button">Cerrar</button>
  </a> 

  </div>
  </div>



    </form>
    <footer>
        <p class="mt-3 mb-5 text-center">&copy; 2025 HRBC</p>
        </footer>
    <br><br><br><br><br>


  </div>
</div>

</body>

</html>